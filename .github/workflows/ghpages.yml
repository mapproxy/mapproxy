name: Build and deploy documentation on github pages

on:
  workflow_dispatch:

jobs:  
  build:
    runs-on: ubuntu-20.04

    steps:
    - name: Checkout sources
      uses: actions/checkout@v4

    - name: Install dependencies ‚è¨
      run: pip install sphinx sphinx-book-theme sphinx-copybutton

    - name: Run documentation build and publish üèóÔ∏è
      run: |
        git config --global user.name 'ghpages'
        git config --global user.email 'ghpages@users.noreply.github.com'
        git fetch --all
        git reset --hard HEAD
        git checkout gh-pages
        git rebase origin/upgrade-docs
        sphinx-build doc/ docs
        git add docs
        git commit -m "Automated documentation"
        git push -f origin gh-pages
